<Activity mc:Ignorable="sap sap2010" x:Class="ExtractInvoiceNo" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:uix="http://schemas.uipath.com/workflow/activities/uix" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="in_FilePath" Type="InArgument(x:String)" />
    <x:Property Name="out_ExtractedCount" Type="OutArgument(x:Int32)" />
    <x:Property Name="in_TransactionItem" Type="InArgument(ui:QueueItem)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1052,1697.14285714286</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>ExtractInvoiceNo_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="58">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>UiPath.UIAutomationNext.Enums</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>UiPath.UIAutomationNext.Activities</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>UiPath.Platform.ObjectLibrary</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="64">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="ExtractInvoiceNo" sap:VirtualizedContainerService.HintSize="557.714285714286,1532" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <ui:LogMessage DisplayName="Starting invoice no extraction" sap:VirtualizedContainerService.HintSize="515.428571428571,95.4285714285714" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Info" Message="[&quot;Starting invoice no extraction...&quot;]" />
    <uix:NApplicationCard AttachMode="ByInstance" CloseMode="Never" DisplayName="Open PDF Invoice" sap:VirtualizedContainerService.HintSize="515.428571428571,1305.14285714286" sap2010:WorkflowViewState.IdRef="NApplicationCard_1" InteractionMode="Simulate" OpenMode="Always" Version="V1">
      <uix:NApplicationCard.Body>
        <ActivityAction x:TypeArguments="x:Object">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="x:Object" Name="WSSessionData" />
          </ActivityAction.Argument>
          <Sequence DisplayName="Perform number extraction" sap:VirtualizedContainerService.HintSize="481.142857142857,1009.14285714286" sap2010:WorkflowViewState.IdRef="Sequence_2">
            <Sequence.Variables>
              <Variable x:TypeArguments="x:String" Name="ExtractedValue" />
              <Variable x:TypeArguments="x:Int32" Name="TryConvertValue" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <uix:NGetText DisplayName="Get Text 'INVOICE #'" sap:VirtualizedContainerService.HintSize="438.857142857143,168" sap2010:WorkflowViewState.IdRef="NGetText_1">
              <uix:NGetText.Target>
                <uix:TargetAnchorable DesignTimeRectangle="1291, 377, 94, 12" ElementType="Text" FriendlyName="'INVOICE #200'" FullSelectorArgument="&lt;wnd aaname='Panel dokumentu' cls='AVL_AVView' title='AVScrolledPageView' /&gt;&lt;wnd cls='AVL_AVView' title='AVPageView' /&gt;&lt;ctrl role='row' /&gt;&lt;ctrl name='INVOICE #200 ' role='text' /&gt;" FuzzyAccuracy="0.9" FuzzySelectorArgument="&lt;wnd aaname='Panel dokumentu' cls='AVL_AVView' title='AVScrolledPageView' /&gt;&lt;wnd cls='AVL_AVView' title='AVPageView' /&gt;&lt;ctrl role='row' /&gt;&lt;ctrl role='text' automationid='' check:text='INVOICE #*' /&gt;" ImageBase64="" InformativeScreenshot="7d2d40eb787d6a08f5937c29221f25ea.png" ScopeSelectorArgument="&lt;wnd app='acrord32.exe' cls='AcrobatSDIWindow' title='Invoice2.pdf - Adobe Acrobat Reader DC (32-bit)' /&gt;" SearchSteps="FuzzySelector" />
              </uix:NGetText.Target>
              <uix:NGetText.Text>
                <OutArgument x:TypeArguments="x:String">[ExtractedValue]</OutArgument>
              </uix:NGetText.Text>
            </uix:NGetText>
            <ui:LogMessage DisplayName="Extracted value" sap:VirtualizedContainerService.HintSize="438.857142857143,95.4285714285714" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Info" Message="[&quot;Extracted value: &quot; &amp; ExtractedValue]" />
            <TryCatch DisplayName="Try Catch convert to Int32" sap:VirtualizedContainerService.HintSize="438.857142857143,299.428571428571" sap2010:WorkflowViewState.IdRef="TryCatch_1">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <TryCatch.Try>
                <Assign DisplayName="Try convert to Int32" sap:VirtualizedContainerService.HintSize="261.714285714286,61.1428571428571" sap2010:WorkflowViewState.IdRef="Assign_1">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:Int32">[TryConvertValue]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:Int32">[CInt(ExtractedValue.Split("#"c)(1))]</InArgument>
                  </Assign.Value>
                </Assign>
              </TryCatch.Try>
              <TryCatch.Catches>
                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404.571428571429,22.8571428571429" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ActivityAction x:TypeArguments="s:Exception">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                    </ActivityAction.Argument>
                    <Sequence DisplayName="Catch sequence - convert to Int32" sap:VirtualizedContainerService.HintSize="326.857142857143,236" sap2010:WorkflowViewState.IdRef="Sequence_3">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:SetTransactionStatus ContinueOnError="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Set transaction status to failed" ErrorType="Business" sap:VirtualizedContainerService.HintSize="284.571428571429,80.5714285714286" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_1" Reason="Failed to convert extracted value to Int!" Status="Failed" TransactionItem="[in_TransactionItem]">
                        <ui:SetTransactionStatus.Analytics>
                          <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                        </ui:SetTransactionStatus.Analytics>
                        <ui:SetTransactionStatus.Output>
                          <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                        </ui:SetTransactionStatus.Output>
                      </ui:SetTransactionStatus>
                      <Throw DisplayName="Throw BRE - failed to convert" Exception="[New BusinessRuleException(&quot;Failed to convert extracted value to Int!&quot;)]" sap:VirtualizedContainerService.HintSize="284.571428571429,21.7142857142857" sap2010:WorkflowViewState.IdRef="Throw_1" />
                    </Sequence>
                  </ActivityAction>
                </Catch>
              </TryCatch.Catches>
            </TryCatch>
            <ui:MultipleAssign DisplayName="Transform extracted value and assign to out arg" sap:VirtualizedContainerService.HintSize="438.857142857143,97.1428571428571" sap2010:WorkflowViewState.IdRef="MultipleAssign_1">
              <ui:MultipleAssign.AssignOperations>
                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_2">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:Int32">[out_ExtractedCount]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:Int32">[TryConvertValue]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                </scg:List>
              </ui:MultipleAssign.AssignOperations>
            </ui:MultipleAssign>
            <ui:LogMessage DisplayName="Assigned value to out arg" sap:VirtualizedContainerService.HintSize="438.857142857143,95.4285714285714" sap2010:WorkflowViewState.IdRef="LogMessage_3" Level="Info" Message="[&quot;Assigned value to out arg: &quot; &amp; TryConvertValue]" />
          </Sequence>
        </ActivityAction>
      </uix:NApplicationCard.Body>
      <uix:NApplicationCard.TargetApp>
        <uix:TargetApp Area="-12, -12, 2584, 1394" Arguments="[in_FilePath]" FilePath="C:\Program Files (x86)\Adobe\Acrobat Reader DC\Reader\acrord32.exe" IconBase64="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" InformativeScreenshot="ae001841c851db1777f2ff12e24c1f51.png" Selector="&lt;wnd app='acrord32.exe' cls='AcrobatSDIWindow' omit:title='Invoice1.pdf - Adobe Acrobat Reader DC (32-bit)' /&gt;" />
      </uix:NApplicationCard.TargetApp>
    </uix:NApplicationCard>
  </Sequence>
</Activity>